# Vulnérabilité

Exemple: http://192.168.X.X/?page=media&src=nsa

En inspectant la page, on s'aperçoit que la source de l'image provient de l'URL.

La balise `<object>` prend un attribute `data` récupéré via le paramètre `src` de l'URL`.

Pour déclencher la faille XSS, on peut passer `<script>alert(1)</script>` encodé en Base64 comme ceci http://192.168.X.X/page=media&src=data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg== .

__Note:__ la faille fonctionne aussi sans encoder en Base64 avec un basique `encodeURI()` mais on obtient pas le flag (http://192.168.X.X/?page=media&src=data:text/html,%3Cscript%3Ealert(1);%3C/script%3E)

Cette faille permet d'envoyer une URL malveillante et d'exécuter du code potentiellement malveillant à l'arrivée du l'utilisateur.

# Solution

On ne doit jamais exécuter du code passé par l'utilisateur.

Pour éviter ce type de faille, on ne doit pas récupérer la source d'un élément via l'URL, l'élément à afficher doit être récupéré côté serveur uniquement.

On peut imaginer un array de mots clés sur le serveur qui permettent d'identifier quel fichier présent sur le serveur doit être envoyé et affiché.
