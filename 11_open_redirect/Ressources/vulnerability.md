# Vulnérabilité

Le site web a une page nommée `redirect` avec un paramètre en query `site` qui redirige l'utilisateur vers l'URL spécifiée. 

C'est une vulnérabilité (Open Redirect/ORED) qui peut être utilisée pour rediriger l'utilisateur sur un autre site web sans qu'il s'aperçoive qu'il n'est plus sur la plateforme d'origine et par exemple sur une page de phishing.

# Solution

Pour se protéger de ce type de faille, nous pouvons imaginer une solution en PHP:

```
$arrayRedirectSite = ['facebook', 'twitter', 'instagram'];
$redirectSite = htmlspecialchars($_GET['site']);

if (in_array($redirectSite, $arrayRedirectSite)) {
	// Redirection
} else {
	// Page Error
}
```

De cette façon, seul les redirections spécifiées dans le tableau côté serveur seront approuvées sinon le serveur renvoie une erreur.