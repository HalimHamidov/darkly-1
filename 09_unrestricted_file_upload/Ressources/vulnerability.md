# Vulnérabilité

Cette vulnérabilité est connue sous le nom de _Unrestricted File Upload_.

C'est un risque élevé car un utilisateur qui peut upload n'importe quel fichier sur un serveur peut ensuite réussir à avoir un reverse shell, prendre le contrôle du serveur et avoir un accès complet sur les données du site web s'il arrive à augmenter ses privilèges.

Dans ce cas-ci nous pouvons falsifier le header `Content-Type` lorsque le fichier est mis en ligne pour faire croire à un fichier valide alors qu'il s'agit d'un `.php`, le serveur semble ne vérifier que cet élement.

# Solution

On ne doit pas faire confiance aux informations passées via un header dans une requête HTTP, elles peuvent être utilisées comme informations pour des utilisations non sensibles.

__Effectuer une suite de vérifications côté serveur:__

1. Vérifier le type de fichier via l'extension (avec `$_FILES` par exemple en PHP)
2. Vérifier la taille du fichier mis en ligne
2. Autoriser uniquement les utilisateurs authentifiés à upload un fichier
3. Ne jamais exécuter/inclure un fichier mis en ligne par un utilisateur

Exemple W3Schools (PHP): https://www.w3schools.com/php/php_file_upload.asp