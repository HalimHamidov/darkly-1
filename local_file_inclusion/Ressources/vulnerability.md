# Vulnérabilité

Le routeur du site fonctionne avec un paramètre `page` en query qui attend un path à inclure dans le code PHP.

Cela permet d'inclure dangereusement n'importe quel fichier, on peut revenir à la racine et obtenir le fichier `/etc/passwd` par exemple:

http://192.168.1.32/index.php?page=../../../../../../../etc/passwd

Cette méthode est connue sous le nom de 'dot dot slash' ou encore 'path/directory traversal'.

Détails:
https://www.offensive-security.com/metasploit-unleashed/file-inclusion-vulnerabilities/

# Solution

Il ne faut pas inclure un path en PHP avec un paramètre en query.

Dans ce cas précis on aurait pu utiliser un mot clé pour chaque page qui correspond à un path spécifique dans le fichier PHP, de cette manière seuls les paths renseignés pourraient être appelés.

```
$pages = array('home' => '../pages/home');

// Access path for page
$pages[$_GET("page")];
```
