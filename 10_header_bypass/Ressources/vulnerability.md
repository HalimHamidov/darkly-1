# Vulnérabilité

Le site web restreint l'accès à une ressource en se basant sur l'origine de la requête et le navigateur utilisé.

Les headers peuvent être modifiés et réécrits, un serveur ne doit jamais faire confiance au contenu des headers, ils peuvent être utiliser comme données pour des opérations non sensibles.

Dans ce cas la vérification est basée sur les headers `Referer` et `User-Agent`.

Les headers attendus dans ce cas sont: 

`Referer=“https://www.nsa.gov/”`
`User-Agent=“ft_bornToSec”`

Note - Différence entre Origin/Referer: `Origin` contient uniquement le domaine et `Referer` le path complet de l'origine de la requête.

Ces informations sont données dans le code source de la page: `http://192.168.X.X/index.php?page=e43ad1fdc54babe674da7c7b8f0127bde61de3fbe01def7d00f151c2fcca6d1c` (accessible dans le footer du site web).

# Solution

Le serveur ne doit pas se baser sur les headers envoyés pour tout le fonctionnement sensible du site car elles peuvent toujours être modifiées. Elles peuvent être utilisées à titre d'information et pour faciliter l'utilisation du site web.

Pour sécuriser une page web qui ne doit être accessible qu'à certains utilisateurs, il convient d'authentifier correctement l'utilisateur et de lui envoyer un token (JWT par exemple) qui permettra au serveur de vérifier si l'accès lui est autorisé et envoyer les informations sensibles.